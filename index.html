<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="SWAG: Surgical Workflow Anticipation with Generative Modelling.">
  <meta name="keywords" content="Surgical AI, Computer Vision, Future Prediction">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>SWAG: Long-term Surgical Workflow Prediction with Generative-based Anticipation</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.png">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://maxboels.github.io/">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          More Research
        </a>
        <div class="navbar-dropdown">
          <a class="navbar-item" href="https://maxboels.github.io/">
            SuPRA
          </a>
          <a class="navbar-item" href="https://maxboels.github.io/">
            LoViT
          </a>
        </div>
      </div>
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <div class="columns is-vcentered">
            <div class="column is-narrow">
              <img src="./static/images/turquoise-cute-octopus-with-surgical-mask-with-crystal-ball.png" alt="SWAG Logo" class="title-image small-title-image">
            </div>
            <div class="column">
              <h1 class="title is-1 publication-title gradient-title">
                SWAG: Long-term Surgical Workflow Prediction with Generative-based Anticipation
              </h1>
            </div>
          </div>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://maxboels.github.io/">Maxence Boels</a>,</span>
            <span class="author-block">
              <a href="">Yang Liu</a>,</span>
            <span class="author-block">
              <a href="">Prokar Dasgupta</a>,
            </span>
            <span class="author-block">
              <a href="">Alejandro Granados</a>, and
            </span>
            <span class="author-block">
              <a href="">Sebastien Ourselin</a>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block">King's College London</span>
            <!-- <span class="author-block"><sup>2</sup>Google Research</span> -->
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- DEMO Link. -->
              <span class="link-block">
                <a href="https://master--surgical-workflow-anticipation-app.netlify.app/"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-desktop"></i>
                  </span>
                  <span>Demo</span>
                </a>
              </span>
              <!-- PDF Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/maxboels/SuPlanner"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <span class="link-block">
                <a href="https://camma.unistra.fr/datasets/"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Cholec80 Videos Combined classification and regression tasks -->
 <!-- best videos are:  68, 77-->
<section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <h3 class="title is-4">Cholec80 Dataset Results</h3>
      <div id="results-carousel-c80" class="carousel results-carousel">
        <div class="item item-c80">
          <p class="has-text-centered mb-2">Video 65</p>
          <video poster="" id="c80-1" autoplay controls muted loop playsinline width="100%" height="500px">
            <source src="./static/videos/c80/futures/video65_h30_s15.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="item item-c80">
          <p class="has-text-centered mb-2">Video 77</p>
          <video poster="" id="c80-2" autoplay controls muted loop playsinline width="100%" height="500px">
            <source src="./static/videos/c80/futures/video77_h30_s15.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <!-- <div class="item item-c80">
          <p class="has-text-centered mb-2">Video 78</p>
          <video poster="" id="c80-3" autoplay controls muted loop playsinline width="100%" height="500px">
            <source src="./static/videos/c80/futures/video78_h30_s15.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="item item-c80">
          <p class="has-text-centered mb-2">Video 79</p>
          <video poster="" id="c80-3" autoplay controls muted loop playsinline width="100%" height="500px">
            <source src="./static/videos/c80/futures/video79_h30_s15.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div> -->
        <div class="item item-c80">
          <p class="has-text-centered mb-2">Video 75</p>
          <video poster="" id="c80-3" autoplay controls muted loop playsinline width="100%" height="500px">
            <source src="./static/videos/c80/futures/" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- AutoLaparo21 Videos Combined classification and regression tasks -->
<!-- <section class="hero is-light is-small">
  <div class="hero-body">
    <div class="container">
      <h3 class="title is-4">AutoLaparo21 Dataset Results</h3>
      <div id="results-carousel-al21" class="carousel results-carousel">
        <div class="item item-al21">
          <p class="has-text-centered mb-2">Video 18</p>
          <video poster="" id="al21-1" autoplay controls muted loop playsinline width="100%" height="500px">
            <source src="./static/videos/al21/futures/video18_h30_s30.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div> -->
        <!-- <div class="item item-al21">
          <p class="has-text-centered mb-2">Video 19</p>
          <video poster="" id="al21-2" autoplay controls muted loop playsinline width="100%" height="500px">
            <source src="./static/videos/al21/futures/video19_h30_s30.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="item item-al21">
          <p class="has-text-centered mb-2">Video 20</p>
          <video poster="" id="al21-3" autoplay controls muted loop playsinline width="100%" height="500px">
            <source src="./static/videos/al21/futures/video20_h30_s30.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div> -->
        <!-- <div class="item item-al21">
          <p class="has-text-centered mb-2">Video 21</p>
          <video poster="" id="al21-4" autoplay controls muted loop playsinline width="100%" height="500px">
            <source src="./static/videos/al21/futures/video21_h30_s30.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
      </div>
    </div>
  </div>
</section> -->


<!-- Embed the React App using an iframe -->
<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Surgical AI Assistant with LLM API</h2>
        <div class="content">
          <p>
            This application demonstrates how future predictions and recognized classes can be translated into textual contextual awareness. The LLM model can be prompted to reply to questions based on its current understanding of the video and its predicted values.
          </p>
          <iframe src="https://master--surgical-workflow-anticipation-app.netlify.app/" width="100%" height="900" frameborder="0" allowfullscreen>
          </iframe>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
            <p>
              <strong>Purpose</strong>
            </p>
            <p>
                Real-time surgical phase anticipation is crucial for improving operating room efficiency and patient safety</strong>. While existing recognition approaches excel at identifying current surgical phases, they provide <strong>limited foresight into future procedural steps</strong>, restricting their intraoperative utility. Similarly, current anticipation methods are constrained to predicting <strong>short-term events or singular occurrences</strong>, neglecting the dynamic and sequential nature of surgical workflows. To address these limitations, we propose SWAG (Surgical Workflow Anticipative Generator), a unified framework for phase recognition and long-term anticipation of surgical workflows.
            </p>
            <p>
              <strong>Methods</strong>
            </p>
            <p>
                <strong>SWAG employs two generative decoding methods—single-pass (SP) and auto-regressive (AR)—to predict sequences of future surgical phases.</strong> A novel <strong>prior knowledge embedding mechanism</strong> enhances the accuracy of anticipatory predictions by integrating statistical priors into token initialisation. The framework addresses <strong>future phase classification and remaining time regression tasks.</strong> Additionally, a <strong>regression-to-classification (R2C) method</strong> is introduced to map continuous predictions to discrete temporal segments. <strong>SWAG's performance was evaluated on the Cholec80 and AutoLaparo21 datasets.</strong>
            </p>
            <p>
              <strong>Results</strong>
            </p>
            <p>
              The single-pass classification model with prior knowledge embeddings (SWAG-SP*) achieved <strong>53.5% accuracy in 15-minute anticipation</strong> on AutoLaparo21, while the R2C model reached <strong>60.8% accuracy</strong> on Cholec80. SWAG's single-pass regression approach outperformed existing methods for remaining time prediction, achieving weighted mean absolute errors of <strong>0.32</strong> and <strong>0.48 minutes</strong> for 2- and 3-minute horizons, respectively.
            </p>
            <p>
              <strong>Conclusion</strong>
            </p>
            <p>
              SWAG demonstrates <strong>versatility across classification and regression tasks</strong>, offering <strong>robust tools for real-time surgical workflow anticipation</strong>. By <strong>unifying recognition and anticipatory capabilities</strong>, SWAG provides <strong>actionable predictions</strong> to enhance intraoperative decision-making. The project webpage is available at https://maxboels.github.io/swag.
            </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->
</section>

<!-- Methods and Results in a single column -->
<section class="section">
  <div class="container is-max-desktop">
    <!-- Methods. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Methods</h2>
        <div class="content">
          <img src="./static/images/model_architecture_with_probs.png" alt="Model Architecture">
          <p>
            Our proposed model, illustrated in Figure 2, comprises a vision encoder, a temporal aggregation module based on self-attention, compression and pooling mechanisms, and a future prediction module that can operate with either a single-pass (SP) or an auto-regressive (AR) decoder. While our model uses classification for the recognition task, it can use either classification or regression for anticipation. This architecture also includes a novel token embedding initialization strategy based on the recognised class and the temporal position of the decoded target token.
          </p>
        </div>
      </div>
    </div>
    <!--/ Methods. -->

    <!-- Results. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Results</h2>
        <div class="content">
          <img src="./static/images/accuracy_future_t.png" alt="Accuracy Results">
          <p>
            Model performance (accuracy) of surgical phase recognition and anticipation on Cholec80 and AutoLaparo21 up to 18 minutes, with mean values over 18 minutes.
          </p>
        </div>
      </div>
    </div>
    <!--/ Results. -->
  </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Conclusion. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Conclusion</h2>
        <div class="content has-text-justified">
          <p>
            We introduced <strong>SWAG</strong>, a pioneering framework that unifies <strong>surgical phase recognition and long-term anticipation</strong> through generative modeling. Our framework demonstrates:
          </p>
          <ul>
            <li><strong>Superior performance</strong> over naive baselines in classification tasks</li>
            <li><strong>Competitive results</strong> in regression tasks, particularly for remaining surgery duration predictions</li>
            <li><strong>Successful integration</strong> of prior knowledge in future-generated tokens</li>
            <li><strong>Real-world applicability</strong> through implementation in a practical software application</li>
          </ul>
          <p>
            Clinically, SWAG's <strong>real-time phase anticipation capabilities</strong> offer valuable support for <strong>intraoperative decision-making</strong>, with potential to enhance both <strong>patient safety and procedural efficiency</strong>. Our evaluation on Cholec80 and AutoLaparo21 datasets validates SWAG as a robust solution for surgical workflow anticipation.
          </p>
        </div>
      </div>
    </div>

    <!-- Future Works. -->
    <div class="columns is-centered">
      <div class="column is-full-width">
        <h2 class="title is-3">Future Works</h2>
        <div class="content has-text-justified">
          <ol>
            <li>Enhance the generative process with <strong>dynamic confidence-based adjustments</strong> for more reliable and robust predictions in clinical scenarios.</li>
            <li>Develop a <strong>vision-language-action framework</strong> by integrating language inputs to enable direct response to surgical team prompts.</li>
            <li>Incorporate <strong>multiple input modalities</strong> including language, audio, and proprioceptive sensory data from surgical robots.</li>
            <li>Expand training labels to cover both <strong>surgical phases and specific action triplets</strong> for finer-grained workflow prediction.</li>
            <li>Address challenges related to <strong>anatomical differences, surgeon skill, and patient-specific factors</strong> for improved real-time adaptability.</li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{boels2024swag,
    title   = {SWAG: Long-term Surgical Workflow Prediction with Generative-based Anticipation},
    author  = {Maxence Boels and Yang Liu and Prokar Dasgupta and Alejandro Granados and Sebastien Ourselin},
    year    = {2024},
    journal = {Submitted to IJCARS}
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="./static/videos/">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://maxboels.github.io/" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This means you are free to borrow the <a
              href="https://github.com/nerfies/nerfies.github.io">source code</a> of this website,
            we just ask that you link back to this page in the footer.
            Please remember to remove the analytics code included in the header of the website which
            you do not want on your website.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
